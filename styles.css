/* =========================================================
   ChatGPT Ambient Blur â€” FULL styles.css
   - Ambient background with bottom gradient
   - Top-weighted white haze over image
   - Glass effects for composer, popovers, and sidebar
   - Legacy composer support (disables glass effects)
   ========================================================= */

/* Page-level transparency when the background is active */
html.cgpt-ambient-on,
html.cgpt-ambient-on body {
  background: transparent !important;
}

/* Fixed container for the blurred background image and overlays */
#cgpt-ambient-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
}

/* Ensure inner layers stretch to fill the container */
#cgpt-ambient-bg picture,
#cgpt-ambient-bg img,
#cgpt-ambient-bg .haze,
#cgpt-ambient-bg .overlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* Background image styling: blurred, scaled, and slightly dimmed */
#cgpt-ambient-bg img {
  object-fit: cover;
  transform: scale(1.08);
  filter: blur(60px) brightness(0.55);
  opacity: 0.58;
  will-change: transform, filter;
  z-index: 0; /* Base layer */
}

/* Top-weighted white haze for a softer look */
#cgpt-ambient-bg .haze {
  pointer-events: none;
  z-index: 2; /* Sits above the black overlay */
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,0.16) 0%,
    rgba(255,255,255,0.10) 22%,
    rgba(255,255,255,0.06) 45%,
    rgba(255,255,255,0.02) 68%,
    rgba(255,255,255,0.00) 85%
  );
}

/* Bottom gradient overlay (black to transparent) */
html.cgpt-ambient-on #cgpt-ambient-bg .overlay {
  pointer-events: none !important;
  z-index: 1; /* Below haze, above image */
  background: linear-gradient(
    to top,
    rgba(0, 0, 0, 0.92) 0%,
    rgba(0, 0, 0, 0.75) 18%,
    rgba(0, 0, 0, 0.50) 36%,
    rgba(0, 0, 0, 0.24) 60%,
    rgba(0, 0, 0, 0.00) 80%
  ) !important;
}

/* =========================================================
   Composer Styling
   ========================================================= */

/* Glass look for the composer, only when not in legacy mode */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  form[data-type="unified-composer"]
  > div:is(.bg-token-bg-primary, [class*="dark:bg"]) {
  background: rgba(255,255,255,0.10) !important;
  border: 1px solid rgba(255,255,255,0.28) !important;
  box-shadow: 0 6px 26px rgba(0,0,0,.20) !important;
  -webkit-backdrop-filter: blur(14px) saturate(140%) !important;
  backdrop-filter: blur(14px) saturate(140%) !important;
}
@media (prefers-color-scheme: dark) {
  html.cgpt-ambient-on:not(.cgpt-legacy-composer)
    form[data-type="unified-composer"]
    > div:is(.bg-token-bg-primary, [class*="dark:bg"]) {
    background: rgba(0,0,0,0.35) !important;
    border: 1px solid rgba(255,255,255,0.14) !important;
    box-shadow: 0 8px 30px rgba(0,0,0,.40) !important;
  }
}

/* Ensure the text input area is also transparent in glass mode */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  form[data-type="unified-composer"] :is(.ProseMirror, textarea) {
  background: transparent !important;
}

/* =========================================================
   Page Element Neutralization
   ========================================================= */

/* Make main content wrappers and key containers transparent */
html.cgpt-ambient-on :is(main, #__next, .bg-token-bg-primary.sticky) {
  background-color: transparent !important;
}

/* Remove the bottom page fade/bar in all modes */
html.cgpt-ambient-on #thread-bottom-container {
  background: transparent !important;
  box-shadow: none !important;
}

html.cgpt-ambient-on #thread-bottom-container.content-fade,
html.cgpt-ambient-on #thread-bottom-container .content-fade {
  -webkit-mask-image: none !important;
  mask-image: none !important;
}

html.cgpt-ambient-on #thread-bottom-container::before,
html.cgpt-ambient-on #thread-bottom-container::after,
html.cgpt-ambient-on #thread-bottom-container .content-fade::before,
html.cgpt-ambient-on #thread-bottom-container .content-fade::after {
  content: none !important;
  background: none !important;
}

/* Ensure footer text has no background bar */
html.cgpt-ambient-on #thread-bottom-container .text-token-text-secondary {
  background: transparent !important;
}

/* =========================================================
   Headers & Sticky Bars
   ========================================================= */

/* Make all sticky top bars transparent by default */
html.cgpt-ambient-on
  :is(header#page-header,
      .sticky.top-0.bg-token-main-surface-primary,
      div.sticky.top-14[class*="bg-token-bg-primary"]
  ) {
  background: transparent !important;
  box-shadow: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
}

/* Strip any pseudo-elements that might paint a background */
html.cgpt-ambient-on
  :is(header#page-header,
      .sticky.top-0.bg-token-main-surface-primary,
      div.sticky.top-14[class*="bg-token-bg-primary"]
  )::before,
html.cgpt-ambient-on
  :is(header#page-header,
      .sticky.top-0.bg-token-main-surface-primary,
      div.sticky.top-14[class*="bg-token-bg-primary"]
  )::after {
  content: none !important;
  background: none !important;
  box-shadow: none !important;
}

/* =========================================================
   Glass UI Surfaces
   ========================================================= */

/* Apply glass to popovers, dialogs, menus, and specific UI components */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  :is(
    .popover.bg-token-main-surface-primary[data-radix-menu-content],
    .popover.bg-token-main-surface-primary[role="dialog"],
    .popover.bg-token-main-surface-primary.max-w-xs, /* Keyboard shortcuts */
    div.sticky.top-14.bg-token-main-surface-primary, /* GPTs category bar */
    input#search[placeholder="Search GPTs"], /* GPTs search bar */
    textarea.bg-token-main-surface-primary.border-token-border-default
  ) {
  background: rgba(255, 255, 255, 0.10) !important;
  border: 1px solid rgba(255, 255, 255, 0.28) !important;
  -webkit-backdrop-filter: blur(14px) saturate(140%) !important;
  backdrop-filter: blur(14px) saturate(140%) !important;
  box-shadow: 0 16px 50px rgba(0, 0, 0, 0.45) !important;
}

/* Dark mode adjustments for glass */
@media (prefers-color-scheme: dark) {
  html.cgpt-ambient-on:not(.cgpt-legacy-composer)
    :is(
      .popover.bg-token-main-surface-primary[data-radix-menu-content],
      .popover.bg-token-main-surface-primary[role="dialog"],
      .popover.bg-token-main-surface-primary.max-w-xs,
      div.sticky.top-14.bg-token-main-surface-primary,
      input#search[placeholder="Search GPTs"],
      textarea.bg-token-main-surface-primary.border-token-border-default
    ) {
    background: rgba(0, 0, 0, 0.35) !important;
    border-color: rgba(255, 255, 255, 0.14) !important;
  }
}

/* Ensure inner containers of dialogs are also transparent */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  .popover[role="dialog"]
  .md\:flex-row.flex-col {
  background-color: transparent !important;
}

/* Keep group separators visible on glass */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  :is(.popover[data-radix-menu-content], .popover[role="dialog"]) [role="group"]::before {
  background: color-mix(in oklab, currentColor 24%, transparent) !important;
}

/* Softer hover effect for items inside glass menus */
html.cgpt-ambient-on:not(.cgpt-legacy-composer)
  :is(.popover[data-radix-menu-content], .popover[role="dialog"]) .__menu-item:hover {
  background: color-mix(in oklab, currentColor 12%, transparent) !important;
}

/* =========================================================
   Custom Additions
   ========================================================= */

.cgpt-gpt5-limit-hidden {
    display: none !important;
}

.cgpt-upgrade-hidden {
    display: none !important;
}

/* Blurred glass effect for the top "Upgrade your plan" button */
html.cgpt-ambient-on:not(.cgpt-legacy-composer) .dark\\:bg-\\[\\#373669\\].flex {
  background: rgba(55, 54, 105, 0.6) !important;
  border: 1px solid rgba(255, 255, 255, 0.14) !important;
  -webkit-backdrop-filter: blur(12px) saturate(140%) !important;
  backdrop-filter: blur(12px) saturate(140%) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

html.cgpt-ambient-on:not(.cgpt-legacy-composer) .dark\\:hover\\:bg-\\[\\#414071\\]:hover {
    background: rgba(65, 64, 113, 0.75) !important;
}

/* =========================================================
   Light mode overrides (MERGED FROM DEVELOPER BRANCH)
   ========================================================= */

/* slightly brighter image in Light mode */
html.cgpt-ambient-on.cgpt-light-mode #cgpt-ambient-bg img {
  filter: blur(60px) brightness(0.99) contrast(1);
  opacity: 0.72;
}

/* reduce the dark top haze a bit */
html.cgpt-ambient-on.cgpt-light-mode #cgpt-ambient-bg .haze {
  background: linear-gradient(
    to bottom,
    rgba(0,0,0,0.153) 0%,
    rgba(0,0,0,0.09) 22%,
    rgba(0,0,0,0.045) 45%,
    rgba(0,0,0,0.0225) 68%,
    rgba(0,0,0,0.00) 85%
  );
}

/* nudge the white overlay up to lift overall luminance */
html.cgpt-ambient-on.cgpt-light-mode #cgpt-ambient-bg .overlay {
  background: linear-gradient(
    to top,
    rgba(255,255,255,0.693) 0%,
    rgba(255,255,255,0.539) 18%,
    rgba(255,255,255,0.346) 36%,
    rgba(255,255,255,0.154) 60%,
    rgba(255,255,255,0.00) 80%
  ) !important;
}

/* composer glass in Light mode: slightly brighter fill, softer edge */
html.cgpt-ambient-on.cgpt-light-mode:not(.cgpt-legacy-composer)
  form[data-type="unified-composer"]
  > div:is(.bg-token-bg-primary, [class*="dark:bg"]) {
  background: rgba(255,255,255,0.088) !important;
  border: 1px solid rgba(0,0,0,0.072) !important;
  box-shadow: 0 6px 26px rgba(0,0,0,0.20) !important;
}

/* popovers in Light mode: lift bg, lighten border */
html.cgpt-ambient-on.cgpt-light-mode:not(.cgpt-legacy-composer)
  .popover.bg-token-main-surface-primary[data-radix-menu-content] {
  background: rgba(255,255,255,0.242) !important;
  border-color: rgba(0,0,0,0.072) !important;
}